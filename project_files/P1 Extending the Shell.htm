<html>
<head>
	<title>CEG4350/CEG5350 - Operating Systems</title>
</head>
<body bgcolor="#FFFFFF" link="#0000FF" vlink="#800080">
<font face="Helvetica,Arial,sans-serif">
<table border=0 width=640 cellspacing=0>
<tr><td width=100% bgcolor="#006f51">&nbsp;</td></tr>
</table>
<table border=0 width=640 cellspacing=0>
<tr><td width=100% bgcolor="#e7a614">&nbsp;</td></tr>
</table>
<p>
<table BORDER=0 CELLSPACING=0 CELLPADDING=3 WIDTH="640">
<tr>
	<td><a href="http://www.wright.edu"><img style="border-style: none" src="../../../images/logo_wsu.jpg" width="100" height="55"
			alt="WSU 2-color logo"></a>
</td>
<td width=440>
<center>
<p><b><font size=+1 color="#006f51" face="Helvetica,Arial,sans-serif">Welcome to
<p><i>CEG4350/CEG5350</i> - Operating Systems
</font></b></center>
</td>
<td><a href="http://avida.cs.wright.edu"><img style="border-style: none" src="../../../images/avida-logo-3D-white.png" width="70" height="58"
		alt="AVIDA"></a>
</table>
<p>
<table border=0 width=640 cellspacing=0>
<tr><td width=100% bgcolor="#e7a614">&nbsp;</td></tr>
</table>
<p>

<font face="Helvetica,Arial,sans-serif">

<table border="0" cellpadding="10" cellspacing="10" width="100%" height="169">
  <tr>
    <td width="67%" height="139">
    <table border="0" width="100%">
      <tr>
        <td width="100%">
        <h3>P1: Extending the Shell</h3>
        </td>
      </tr>
      <tr>
        <td width="100%">
        <h4><b><a href="http://avida.cs.wright.edu/courses/CEG4350/">CEG 
        4350/5350: Operating Systems</a></b></h4>
        </td>
      </tr>
      <tr>
        <td width="100%">
        <h4> <b><a href="source.tar.bz2">Download source.tar.bz2</a></b></h4>
        </td>
      </tr>
      </table>
    </td>
  </tr>
</table>
<table bgcolor="#006f51" border="0" cellpadding="0" cellspacing="0" 
width="100%">
  <tr>
    <td>&nbsp;</td>
    <td align="right">&nbsp;</td>
  </tr>
</table>
<p>The project for the current term is to implement (on a simulated disk) a file system based on the design explored in the 
lectures.&nbsp; This project is divided into four pieces.
&nbsp; You must read and follow the
<a href="4350projects.html">Project Expectations</a>.&nbsp; Study the grading 
sheet given below.</p><p>This is Part 0 of the project for this term.&nbsp; You are expected to study and modify the 
source code files given in <code>source.tbz</code> and achieve the functionality described below.&nbsp; Do not use source code files 
of others or even those of mine but from prior terms.&nbsp; </p>
<p><b>Be Considerate. </b>Do make sure that you are not using up too much space 
(say &gt; 10 MB) in your home directory.&nbsp; The following will show your disk 
space usage:&nbsp; <code>du -s ~</code></p>

<h2>1. Learn Unix Commands</h2>

<p>Coming into the course, you are expected to be comfortable with
Unix commands.  Try all the commands of
the<a
href="MinUnixCmd.html">
Minimal List of Unix Commands</a>&nbsp; You cannot claim to be
Unix-familiar unless you have used them all a few times.&nbsp; Use
script (read <code>man script</code>) to demonstrate that you
invoked&nbsp; the commands.&nbsp; A few commands cannot be run unless
you are super user; for such commands, just capture its message.  Turn
this file in as a file named <code>cmdsTried.txt.</code></p>

<h2>2. Studying a Program</h2>

<p>By the time P1 is due, we would have covered the process management necessary for this project.

The tar ball <code>source.tbz</code> is a collection of files given so
that (i) you can get started quickly with our project, and (ii) you can see the style of how larger systems programs are written. Download <code>source.tbz</code> from the link
above.&nbsp; In a Linux environment, it can be un-tar-ed as follows:&nbsp; <code>tar xvvfj source.tbz</code><p>The functionality of&nbsp; <code>source.tbz</code>&nbsp; is 
described in <a href="4350P1.html#4.0_What_Is_Given_">What Is Given</a>.  Some details of the code are/were explained in the lectures and in
<a href="ReadMe.txt">ReadMe.txt</a>. Study the provided source code
<i>so thoroughly that you could have written it</i>. At this point, you can focus on the files <code>fs33types.hpp</code> and <code>shell.cpp</code>Then, answer the itemized questions below in a file named
<code>answers.txt.</code></p>

<ol>

  <li>The following  are standard library routines:<br>
    <code>dup2, creat, pipe, fork, pthread_create, system, printf</code><br>Look up their
functionality in both the Stevens' book and the on-line man
pages.&nbsp; Describe their functionality briefly, one sentence each,
in <b>your own words</b>.</li>

<li> In the file
<code>shell.cpp</code>, what is the point of the last line of the function <code>invokeCmd</code>?
</ol>

<h2>3. Learn to Use GDB</h2>

Coming into the course, you are expected to be comfortable with <code>gdb</code>.

Debugging large programs requires the construction of (extra) observer
methods.  Using <code>gdb</code> or some other debugger is not as
effective as invoking observers and studying their output in a
peaceful place ("under a tree").  Nevertheless, gdb can be useful as a
last resort, and you must be able to use it well.

<ol>
  <li>Start <code>script</code>. Make P0 as given. Run our program P0 through gdb.</li>
  <li>Set a breakpoint at immediately after <code>main()&nbsp; </code>Examine the values of
  <code>buf, arg, types, nArgs</code> while tracing down the code</li>
  <li>Type in a command to our shell, such as <code>mkfs D1</code>. Trace the
execution from the above breakpoint onwards by single stepping until
you reach the end of the fucntion <code>invokeCmd</code>.</li>
  <li>Type in <code>!ls</code> request and trace. Do you notice a difference?</li>
  <li>End the script.&nbsp; Turn in this script as a file named <code>
gdbSession.txt</code></li>
</ol>

<h2>4. Additions and Improvements</h2>
<p>Part of large program development is independently, but wisely,
deciding what to do for certain "erroneous" situations. Should we ask
the professor for what to do for every possible error you can think
of?  [Answer: No. You think about it. You take a reasonable
action. You document this in your source code, and in
<code>ReadMe.txt</code>. And, be ready to defend your choice should it
be questioned.] Remember that one of the goals of CEG 433/633 is to
make you think about larger programs. Part of this is to supply
missing, but needed, details in the problem description.</p>

<h3><a name="4.0_What_Is_Given_">4.0 What Is Given</a></h3><p>

As given, the files of <code>source.tbz</code> implement the following.&nbsp; </p>
<dl>
  <dt><code><strong>fs33% mkfs D1 </strong></code></dt>
  <dd>creates an initially empty file volume on the simulated
disk named <code>D1.dsk</code>. At this point, we do not need to discuss all the specifics anout the structure of the disk


  <dt><strong><code>fs33% ls</code></strong><b> </b></dt>
  <dd>prints a listing, much like the Unix <code>ls -lisa</code>, of
all the files in the <code>root</code> directory of the current file
volume. </dd>
<p>Here is a <a href="stdTestScriptP1.txt">stdTestScriptP1.txt</a>.&nbsp; Use it as in <code>./P0 &lt; stdTestScriptP1.txt </code>.</p>

<h3>4.1 Redirection</h3>

Implement redirection for the given shell as discussed in class. Use the operator <code>&gt;</code> to redirect the output of a command into a file on the host's file system. It is safe to assume that the redirection operator appears only once in the command line.

<h3>4.2 Piping</h3>

Implement piping as discussed in class for commands executed on the host. For example, the command <code>!ls | !cat</code> executes both commands on the host. However, the piping needs to be performed in your shell! It is sufficent if your shell supports single piping, i.e. the concatenation of two commands. Bonus points are available if you achieve multiple piping.

<h3>4.3 Executing in the background</h3>

Allow your shell to execute commands in the background using the &amp;. The command prompt should return immediately after issuing the command no matter how long the execution takes. It is safe to assume that the character &amp; only appears once in the command. Your shell should support the execution of all types of commands in the background, i.e. local commands operating on the virtual file system as well as commands running on the host.

<h3>4.4 A Simple Test Session</h3>
<p> <i>Only</i> the additional elements compared to the given source code are described below.&nbsp;&nbsp; Add 
these appropriately to the <code>test script</code>.&nbsp; Our path name syntax is 
the same as Unix path names.&nbsp;&nbsp; Obviously, 
not every arbitrary string is a valid path or name.&nbsp; Also, the dot and the 
dot-dot are not permissible as arguments in some contexts below.&nbsp; 
Nevertheless these commands must be robust.</p>
<dl>
<dl>
  <dt><strong><tt>fs33% ls > test</tt></strong></dt>
  <dd>lists the contents of the current directory of our own file system and redirects the output into the file <code>test</code> of the local directory of the host's file system.</dd>
  <dt><strong><tt>fs33% ls | !cat</tt></strong> </dt>
  <dd>pipes the output of <code>ls</code> into the local command <code>cat</code>.</dd>
  <dt><tt><strong>fs33% !cat test</strong></tt></dt>
  <dd>shows the contents of the file test of the host's file system (which should contain the output of <code>ls</code> if previously executed as above).</dd>
  <dt><tt><strong>fs33% !sleep 15 &amp;</strong></tt></dt>
  <dd>waits 15 seconds (since it is executed in the background the command prompt should be available immediately, though).</dd>
</dl>
</dl>
<h2>5. Turn In</h2>
<p> All projects need to be submitted via <a href="https://pilot.wright.edu">
Pilot</a>.
&nbsp;</p>
<hr size="4">
<table border="0" cellpadding="10" cellspacing="10" width="100%">
  <tr>
    <td width="67%">
    <table border="0" width="100%">
      <tr>
        <td width="100%">
        <h3><a name="Grading Sheet for Part 2">Grading Sheet for&nbsp;</a><br>
    <b><a href="http://www.cs.wright.edu/~pmateti/Courses/4350/">CEG 4350/5350:
    Operating Systems</a></b><br>
        P1: Extending the Shell</h3>
        </td>
      </tr>
      <tr>
        <td width="100%">Instructor = 
<a href="mailto:thomas.wischgoll@wright.edu?subject=CEG4350"> Thomas Wischgoll</a>;&nbsp;
        </td>
      </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="33%" colspan="2">Extra credit points are awarded in recognition of good work and 
		extra work, in addition to the max possible points.&nbsp; Quality is 
		subjectively judged.&nbsp; Merely turning in a file will not receive 
		full score.&nbsp; Some items have a cascading effect.</td>
  </tr>
<table width="100%" border="1">
  <tr>
    <td><font size="4" width="80%">Item description</font></td>
    <td align="right"><font size="4" width="5%">Max</font></td>
    <td align="right"><font size="4" width="10%">Points</font></td>
  </tr>
  <tr>
      <td><code>ReadMe.txt</code> exists with content as described in <a
 href="4350projects.html">Project Expectations</a></td>
      <td align="right">5</td>
      <td align="right">&nbsp;</td>
    </tr>
  <tr>
    <td><code><strong><i>Your</i> testscript.txt </strong></code>is designed so that all the functionality 
    is demonstrated, including robustness.<i> </i></td>
    <td align="right">5</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
    <td>Your program successfully navigates your own<code><b> testscript.txt.</b></code>&nbsp; 
    (<i> If</i> yours is too simple, we may run it through our script that you 
    will get to see only after the due date.)</td>
    <td align="right">5</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
      <td><code>cmdsTried.txt </code>shows use of&nbsp; at least 10 of
      <a
 href="MinUnixCmd.html">
Minimal List of Unix Commands</a></td>
      <td align="right">5</td>
      <td>&nbsp;</td>
    </tr>
  <tr>
      <td><code>answers.txt</code></td>
      <td align="right">10</td>
      <td>&nbsp;</td>
    </tr>
  <tr>
      <td><code>gdbSession.txt</code></td>
      <td align="right">10</td>
      <td>&nbsp;</td>
    </tr>
  <tr>
    <td><b><code>ls > test</code></b> </td>
    <td align="right">20</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
    <td><code><b>ls | !cat</b></code></td>
    <td align="right">20</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
    <td><code><b>!sleep 15 &amp; (background execution)</b></code></td>
    <td align="right">20</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
    <td>Bonus points 25, if you implement multiple piping, i.e. you can set up a piped command consisting of more than two commands.</td>
    <td align="right">B25</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
    <td>Files were not submitted using <code>pilot</code> = minus 10 
    points</td>
    <td align="right">-10</td>
    <td align="right">&nbsp;</td>
  </tr>
  <tr>
    <td><b>Total</b></td>
    <td align="right">100</td>
    <td align="right">&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" bgcolor="#006f51" 
border="0">
  <tr>
    <td align="right">&nbsp;</td>
  </tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td width="71%">Copyright ©
    2020 <a href="mailto:pmateti@wright.edu?subject=CEG4350">pmateti@wright.edu</a>, <a href="mailto:thomas.wischgoll@wright.edu?subject=CEG4350">thomas.wischgoll@wright.edu</a></td>
    <td align="right" width="29%"><br>
    </td>
  </tr>
</table>

</body>

</html>
